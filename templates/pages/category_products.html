{% extends 'base/homebase.html' %}
{% block title %}{{ catdata.title }} Products{% endblock %}

{% block sidebar %} {% include 'components/sidebar.html' %} {% endblock %}

{% block body %}

<!-- BREADCRUMB -->
<div id="breadcrumb">
    <div class="container">
        <ul class="breadcrumb">
            <li><a href="/">Home</a></li>
            <li class="active">{{ catdata.title }} Products </li>
        </ul>
    </div>
</div>
<!-- /BREADCRUMB -->
<!-- section -->
<div class="section">
    <!-- container -->
    <div class="container">
        <!-- row -->
        <div class="row">
            <!-- ASIDE -->
             <div id="aside" class="col-md-3">
                <!-- aside widget -->
                <div class="aside">
                    <h3 class="aside-title">Shop by:</h3>
                    
                    <ul class="filter-list">
                        <li><span class="text-uppercase">Price:</span></li>
                        <li><strong>MIN: ${{minPrice }}</strong></li>
                        <li><strong>MAX: ${{ maxPrice }}</strong></li>
                    </ul>
                </div>
                <!-- /aside widget -->

                <!-- aside widget -->
                <div class="aside">
                    <h3 class="aside-title">Filter by Price</h3>
                    <div id="price-slider"></div>
                </div>
            </div> 
            <!-- /ASIDE -->

            <!-- MAIN -->
            <div id="main" class="col-md-9">
                <!-- store top filter -->
                <div class="store-filter clearfix">
                    <div class="pull-left">
                        <!-- <div class="row-filter">
                            <a href="#"><i class="fa fa-th-large"></i></a>
                            <a href="#" class="active"><i class="fa fa-bars"></i></a>
                        </div> -->
                        <div class="sort-filter">
                            <span class="text-uppercase">Sort by :</span>
                            <select id="sortByInput" class="input" onchange="onChangeFilter()">
                                <option value="title">None</option>
                                <option value="price">Price</option>
                                <option value="orderproduct">Ordered</option>
                            </select>
                        </div>
                    </div>
                    <!-- <div class="pull-right">
                        <div class="page-filter">
                            <span class="text-uppercase">Show:</span>
                            <select class="input">
                                <option value="0">10</option>
                                <option value="1">20</option>
                                <option value="2">30</option>
                            </select>
                        </div>
                        <ul class="store-pages">
                            <li><span class="text-uppercase">Page:</span></li>
                            <li class="active">1</li>
                            <li><a href="#">2</a></li>
                            <li><a href="#">3</a></li>
                            <li><a href="#"><i class="fa fa-caret-right"></i></a></li>
                        </ul>
                    </div> -->
                </div> 
                <!-- /store top filter -->

                <!-- STORE -->
                <div id="store">
                    <!-- row -->
                    <div class="row d-flex">

                        <div class="col-md-12">
                            <div class="order-summary clearfix">
                                <div class="section-title">
                                    <h3 class="title">Product List</h3>
                                </div>
                                    <!-- row -->
                                    <div class="row">
                                
                                        <!-- section title -->
                                        {% for rs in products_latest %}
                                        <!-- Product Single -->
                                        <div class="col-md-4 col-sm-6 col-xs-6">
                                            <div class="product product-single">
                                                <div class="product-thumb" style="width: 100%;">
                                                    <img src="{{ rs.image.url }}" alt="" style="width: 100%; object-fit: contain;">
                                                </div>
                                                <div class="product-body">
                                                    <h3 class="product-price">${{ rs.price }}</h3>
                                                    <div class="product-rating">
                                                        <i class="fa fa-star{% if rs.avaregereview < 1%}-o empty{% endif%}"></i>
                                                        <i class="fa fa-star{% if rs.avaregereview < 2%}-o empty{% endif%}"></i>
                                                        <i class="fa fa-star{% if rs.avaregereview < 3%}-o empty{% endif%}"></i>
                                                        <i class="fa fa-star{% if rs.avaregereview < 4%}-o empty{% endif%}"></i>
                                                        <i class="fa fa-star{% if rs.avaregereview < 5%}-o empty{% endif%}"></i>
                                                        {{ rs.avaregereview}}/{{ rs.countreview}}
                                
                                                    </div>
                                                    <h2 class="product-name"><a href="{% url 'product_detail' rs.id rs.slug %}">{{ rs.title }}</a></h2>
                                                    <div class="product-btns">
                                                        <a href="/user/addtowishlist/{{ rs.id }}" class="main-btn icon-btn"><i class="fa fa-heart"></i></a>
                                                        <button class="main-btn icon-btn"><i class="fa fa-exchange"></i></button>
                                                        {% if rs.variant == 'None'%}
                                                        <a href="/order/addtoshopcart/{{ rs.id }}" class="primary-btn add-to-cart"><i
                                                                class="fa fa-shopping-cart"></i> Add to Cart</a>
                                                        {% else %}
                                                        <a href="{% url 'product_detail' rs.id rs.slug %}" class="primary-btn add-to-cart"><i
                                                                class="fa fa-shopping-cart"></i> Detail</a>
                                                        {% endif %}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- /Product Single -->
                                        {% endfor %}
                                
                                    </div>
                                    <!-- /row -->
                                
                                
                                    <!-- row -->
                                    <div class="row d-flex" style="display: flex; flex-wrap: wrap;">
                                        <!-- section title -->
                                        {% for rs in products %}
                                        <!-- Product Single -->
                                        <div class="col-md-4 col-sm-6 col-xs-6">
                                            <div class="product product-single">
                                                <div class="product-thumb" style="width: 100%; height: 300px;">
                                                    <img src="{{ rs.image.url }}" alt="" style="width: 100%;">
                                                </div>
                                                <div class="product-body">
                                                    <h3 class="product-price">${{ rs.price }} </h3>
                                                    <div class="product-rating">
                                                        <i class="fa fa-star{% if rs.avaregereview < 1%}-o empty{% endif%}"></i>
                                                        <i class="fa fa-star{% if rs.avaregereview < 2%}-o empty{% endif%}"></i>
                                                        <i class="fa fa-star{% if rs.avaregereview < 3%}-o empty{% endif%}"></i>
                                                        <i class="fa fa-star{% if rs.avaregereview < 4%}-o empty{% endif%}"></i>
                                                        <i class="fa fa-star{% if rs.avaregereview < 5%}-o empty{% endif%}"></i>
                                                        {{ rs.avaregereview}}/{{ rs.countreview}}
                                                    </div>
                                                    <h2 class="product-name"><a href="{% url 'product_detail' rs.id rs.slug %}">{{ rs.title }}</a></h2>
                                                    <div class="product-btns">
                                                        <a href="/user/addtowishlist/{{ rs.id }}" class="main-btn icon-btn"><i class="fa fa-heart"></i></a>
                                                        <button class="main-btn icon-btn"><i class="fa fa-exchange"></i></button>
                                                        {% if rs.variant == 'None'%}
                                                        <a href="{% url 'addtoshopcart' rs.id %}" class="primary-btn add-to-cart"><i
                                                                class="fa fa-shopping-cart"></i> Add to Cart</a>
                                                        {% else %}
                                                        <a href="{% url 'product_detail' rs.id rs.slug %}" class="primary-btn add-to-cart"><i
                                                                class="fa fa-shopping-cart"></i> Detail</a>
                                                        {% endif %}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- /Product Single -->
                                        {% endfor %}
                                    </div>
                                    <!-- /row -->
                                
                                <!-- <table class="shopping-cart-table table">
                                    <thead>
                                        <tr>
                                            <th>Product</th>
                                            <th style="width: 700px;"></th>
                                            <th class="text-center">Price</th>
                                            <th class="text-right"></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for rs in products %}
                                        <tr>
                                            <td class="thumb"><a href="{% url 'product_detail' rs.id rs.slug %}">
                                                    <img src="{{ rs.image.url }}" alt="" style="height: 100px">
                                                </a></td>
                                            <td class="details"> <a
                                                    href="{% url 'product_detail' rs.id rs.slug %}">{{ rs.title }}</a>
                                                    <div class="product-rating">
                                                        <div class="product-rating-stars">
                                                            <i class="fa fa-star{% if rs.avaregereview < 1%}-o empty{% endif%}"></i>
                                                            <i class="fa fa-star{% if rs.avaregereview < 2%}-o empty{% endif%}"></i>
                                                            <i class="fa fa-star{% if rs.avaregereview < 3%}-o empty{% endif%}"></i>
                                                            <i class="fa fa-star{% if rs.avaregereview < 4%}-o empty{% endif%}"></i>
                                                            <i class="fa fa-star{% if rs.avaregereview < 5%}-o empty{% endif%}"></i>
                                                        </div>
                                                        {{ rs.avaregereview |stringformat:".2f"}}
                                                    </div>
                                            </td>
                                            <td class="price text-center">
                                                <strong>$ {{ rs.price }}</strong><br></td>
                                                <td>
                                                {% if rs.variant == 'None'%}
                                                <a href="/order/addtoshopcart/{{ rs.id }}" class="primary-btn add-to-cart"><i
                                                        class="fa fa-shopping-cart"></i> Add to Cart</a>
                                                {% else %}
                                                <a href="{% url 'product_detail' rs.id rs.slug %}" class="primary-btn add-to-cart"><i
                                                        class="fa fa-shopping-cart"></i> Detail</a>
                                                {% endif %}</td>
                                        
                                        </tr>
                                        {% endfor %}

                                    </tbody>

                                </table> -->

                            </div>

                        </div>

                    </div>
                    <!-- /row -->
                </div>
                <!-- /STORE -->

                <!-- store bottom filter -->
                {% comment %} <div class="store-filter clearfix">
                    <div class="pull-left">
                        <div class="row-filter">
                            <a href="#"><i class="fa fa-th-large"></i></a>
                            <a href="#" class="active"><i class="fa fa-bars"></i></a>
                        </div>
                        <div class="sort-filter">
                            <span class="text-uppercase">Sort By:</span>
                            <select class="input">
                                <option value="0">Position</option>
                                <option value="0">Price</option>
                                <option value="0">Rating</option>
                            </select>
                            <a href="#" class="main-btn icon-btn"><i class="fa fa-arrow-down"></i></a>
                        </div>
                    </div>
                    <div class="pull-right">
                        <div class="page-filter">
                            <span class="text-uppercase">Show:</span>
                            <select class="input">
                                <option value="0">10</option>
                                <option value="1">20</option>
                                <option value="2">30</option>
                            </select>
                        </div>
                        <ul class="store-pages">
                            <li><span class="text-uppercase">Page:</span></li>
                            <li class="active">1</li>
                            <li><a href="#">2</a></li>
                            <li><a href="#">3</a></li>
                            <li><a href="#"><i class="fa fa-caret-right"></i></a></li>
                        </ul>
                    </div>
                </div> {% endcomment %}
                <!-- /store bottom filter -->
            </div>
            <!-- /MAIN -->
        </div>
        <!-- /row -->
    </div>
    <!-- /container -->
</div>
<!-- /section -->

<script>
     // SORT BY
        const onChangeFilter = (event) => {
            const sortBy = document.getElementById('sortByInput').value;
            const searchParams = new URLSearchParams(window.location.search);
            const minPrice = searchParams.get("minPrice") || 1;
            const maxPrice = searchParams.get("maxPrice") || 999;
            window.history.pushState(
                {},
                "",
                `?minPrice=${minPrice}&maxPrice=${maxPrice}&sortBy=${sortBy}`
            );
            window.location.reload();
        };
        
</script>


{% endblock %}